name: Copy Systematik File and Move/Rename

on:
  push:
    branches:
      - main

jobs: 
  copy-file:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Copy and Move/Rename File
      run: |
        cd source
        latest_file=$(ls -t | head -n1)
        cp $latest_file ../dist/sys.xml
      shell: bash
  
    - name: Add XSL Declaration
      run: |
        cd dist
        sed -i '2i\<?xml-stylesheet type="text/xsl" href="sys.xsl"?>' sys.xml
      shell: bash

    - name: Commit and Push Changes
      run: |      
        git config --global user.name "GitHub Actions"
        git config --global user.email "actions@github.com"
        git add .
        git commit -m "Copy and move/rename file"
        git push